<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Ansible Workshops latest | Workshop | Exercise 1.1</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css">
  <link href="../../latest/_stylesheets/docs.css" rel="stylesheet" />
  <link href="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png" rel="apple-touch-icon-precomposed" type="image/png">
  <link href="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png" name="msapplication-TileImage">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://assets.openshift.net/content/html5shiv.js" type="text/javascript"></script>
    <script src="https://assets.openshift.net/content/respond.js" type="text/javascript"></script>
    <link href="https://assets.openshift.net/content/vendor/respond-js/respond-proxy.html" id="respond-proxy" rel="respond-proxy">
    <link href="../../latest/_images/respond.proxy.gif" id="respond-redirect" rel="respond-redirect">
    <script src="../../latest/_javascripts/respond.proxy.js" type="text/javascript"></script>
  <![endif]-->
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="../../latest/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script type="text/javascript" src="https://assets.openshift.net/app/assets/site/tracking.js"></script>
</head>
<body>
  <div class="navbar navbar-default navbar-openshift" role="navigation">
  <div class="navbar-header">
    <div class="dropdown">
      <a href="#" class="dropdown-toggle navbar-menu-toggle" data-toggle="dropdown">
        <span class="navbar-menu-title">MENU</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <ul class="dropdown-menu navbar-menu" role="menu">
        <li class="submenu">
          <a href="#">Overview</a>
          <ul id="submenu-overview" class="dropdown-submenu">
            <li class="submenu-heading">Public Sector Workshop</li>
            <li>
                What is Ansible Tower?
                <span class="submenu-item-desc">Extend the power of Ansible to your entire team. Ansible Tower by Red Hat helps you scale IT automation, manage complex deployments and speed productivity. Centralize and control your IT infrastructure with a visual dashboard, role-based access control, job scheduling and graphical inventory management.</span>
              </a>
            </li>
            <li class="submenu-heading">Links</li>
            <li>
              <a href="https://www.ansible.com/tower">
                Ansible Tower
                <span class="submenu-item-desc">Learn more about Ansible Tower.</span>
              </a>
            </li>
            <li>
              <a href="https://www.ansible.com/">
                Ansible
                <span class="submenu-item-desc">Ansible seamlessly unites workflow orchestration with configuration management, provisioning, and application deployment in one easy-to-use and deploy platform.</span>
              </a>
            </li>
            <li>
              <a href="https://galaxy.ansible.com/">
                Ansible Galaxy
                <span class="submenu-item-desc">Jump-start your automation project with great content from the Ansible community. Galaxy provides pre-packaged units of work known to Ansible as roles. Roles can be dropped into Ansible PlayBooks and immediately put to work. You'll find roles for provisioning infrastructure, deploying applications, and all of the tasks you do everyday.</span>
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Connect</a>
          <ul id="submenu-connect" class="dropdown-submenu">
            <li>
              <a href="https://access.redhat.com/downloads/">
                Downloads <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://dgshow.org/">
                The Dave and Gunnar Show
              </a>
            </li>
            <li>
              <a href="https://twitter.com/redhatgov">
                Twitter <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.facebook.com/openshift">
                Facebook <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.linkedin.com/company/red-hat">
                LinkedIn <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://github.com/RedHatGov">
                GitHub <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://plus.google.com/+RedHat">
                Google+ <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.youtube.com/user/RedHatVideos">
                YouTube <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
          </ul>
        </li>
      <li class="submenu">
        <a href="#">Contact Us</a>
        <ul id="submenu-connect" class="dropdown-submenu">
          <li>
             <a href="https://www.redhat.com/en/about/contact/sales2">
             Contact Us
             </a>
          </li>
        </ul>
    </div>
    <a class="navbar-brand red-hat-public-sector" href="/"></a>
  </div>
  <!-- <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="hidden-xs dropdown"> <a href="#" class="dropdown-toggle nav-log-in" data-toggle="dropdown"> My Account<span class="caret"></span> </a>
        <ul class="dropdown-menu">
          <li><a href="https://openshift.redhat.com/app/console">OpenShift Web Console</a></li>
          <li><a href="https://console.preview.openshift.com/">(Next Gen) Web Console</a></li>
          <li><a href="https://hub.openshift.com/users/auth/github">OpenShift Hub</a></li>
        </ul>
      </li>
      <li class="hidden-xs hidden-sm"><a class="nav-sign-up" href="https://www.openshift.com/devpreview/register.html">Sign up for Free</a></li>
    </ul>
  </div> -->
</div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../index.html">Ansible</a>
      </li>
      <li class="hidden-xs active">
        <a href="../workshop-austin/index.html">Ansible Workshops latest</a>
      </li>
      <li class="hidden-xs active">
        <a href="../workshop-austin/index.html">Workshop</a>
      </li>
      
      <li class="hidden-xs active">
        Exercise 1.1
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <div class="row-fluid">
          <script>
  (function() {
    var cx = '013769182564158614814:e-dp46b51vk';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Workshop
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../workshop-austin/index.html">Agenda</a></li>
            <li><a class="" href="../workshop-austin/setup.html">Setup</a></li>
            <li><a class="" href="../workshop-austin/exercise1.0.html">Exercise 1.0</a></li>
            <li><a class=" active" href="../workshop-austin/exercise1.1.html">Exercise 1.1</a></li>
            <li><a class="" href="../workshop-austin/exercise1.2.html">Exercise 1.2</a></li>
            <li><a class="" href="../workshop-austin/exercise1.3.html">Exercise 1.3</a></li>
            <li><a class="" href="../workshop-austin/exercise1.4.html">Exercise 1.4</a></li>
            <li><a class="" href="../workshop-austin/exercise1.5.html">Exercise 1.5</a></li>
            <li><a class="" href="../workshop-austin/wrapup.html">Wrap Up</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>Resources
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../resources/links.html">Links</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Exercise 1.1 - Writing Your First playbook</h2>
        </div>
        <hr>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Now that you&#8217;ve gotten a sense of how ansible works, we are going to write our first
ansible <strong>playbook</strong>.  The playbook is where you can take some of those ad-hoc commands you just ran
and put them into a repeatable set of <strong>plays</strong> and <strong>tasks</strong>.</p>
</div>
<div class="paragraph">
<p>A playbook can have multiple plays and a play
can have one or multiple tasks.  The goal of a <strong>play</strong> is to map a group of hosts.  The goal of a <strong>task</strong> is to implement modules against those hosts.</p>
</div>
<div class="paragraph">
<p>For our first playbook, we are only going to write one play and two tasks.</p>
</div>
<div class="paragraph lead">
<p>Section 1 - Creating a Directory Structure and Files for your Playbook</p>
</div>
<div class="paragraph">
<p>There is a <a href="http://docs.ansible.com/ansible/playbooks_best_practices.html">best practice</a> on the preferred directory structures for playbooks.  We strongly encourage
you to read and understand these practices as you develop your Ansible ninja skills.  That said,
our playbook today is very basic and creating a complex structure will just confuse things.</p>
</div>
<div class="paragraph">
<p>Instead, we are going to create a very simple directory structure for our playbook, and add just a couple of files to it.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Step 1: Create a directory called <strong>apache_basic</strong> in your home directory and change directories into it</p>
</div>
<div class="listingblock">
<div class="content">
<pre>% mkdir ~/apache_basic
% cd ~/apache_basic</pre>
</div>
</div>
<div class="paragraph">
<p>Step 2: Define your inventory.  Inventories are crucial to Ansible as they define remote machines on which you wish to run
your playbook(s).  Use <code><code>vi</code></code> or <code><code>vim</code></code> to create a file called <code><code>hosts</code></code>.  Then, add the appropriate definitions which can
be viewed in <code><code>~/lighbulb/inventory</code></code>.  (And yes, I <strong>suppose</strong> you could copy the file, but we&#8217;d rather you type it in so you can
become familiar with the syntax)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[web]
node-1 ansible_host=&lt;IP Address of your node-1&gt;
node-2 ansible_host=&lt;IP Address of your node-2&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Step 3: Use <code><code>vi</code></code> or <code><code>vim</code></code> to open a file called <code><code>install_apache.yml</code></code></p>
</div>
</div>
</div>
<div class="paragraph lead">
<p>Section 2 - Defining Your Play</p>
</div>
<div class="paragraph">
<p>Now that you are editing <code><code>install_apache.yml</code></code>, let&#8217;s begin by defining the play and then understanding what each line accomplishes</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">---
- hosts: web
  name: Install the apache web service
  become: yes</code></pre>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code><code>---</code></code> Defines the beginning of YAML</p>
</li>
<li>
<p><code><code>hosts: web</code></code> Defines which host group in your inventory on which this play will run against</p>
</li>
<li>
<p><code><code>name: Install the apache web service</code></code> This describes our play</p>
</li>
<li>
<p><code><code>become: yes</code></code> Enables user privilege escalation.  The default is sudo, but su, pbrun, and <a href="http://docs.ansible.com/ansible/become.html#new-command-line-options">several others</a> are also supported.</p>
</li>
</ul>
</div>
<div class="paragraph lead">
<p>Section 3: Adding Tasks to Your Play</p>
</div>
<div class="paragraph">
<p>Now that we&#8217;ve defined your play, let&#8217;s add some tasks to get some things done</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">tasks:
 - name: install apache
   yum:
     name: httpd
     state: present

 - name: start httpd
   service:
     name: httpd
     state: started</code></pre>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code><code>tasks:</code></code> This denotes that one or more tasks are about to be defined</p>
</li>
<li>
<p><code><code>- name:</code></code> Each task requires a name which will print to standard output when you run your playbook.
Therefore, give your tasks a name that is short, sweet, and to the point</p>
</li>
</ul>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">yum:
  name: httpd
  state: present</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>These three lines are calling the Ansible module <strong>yum</strong> to install httpd.
<a href="http://docs.ansible.com/ansible/yum_module.html">Click here</a> to see all options for the yum module.</p>
</li>
</ul>
</div>
<hr>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">service:
  name: httpd
  state: started</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The next few lines are using the ansible module <strong>service</strong> to start the httpd service.  The service module
is the preferred way of controlling services on remote hosts.  <a href="http://docs.ansible.com/ansible/service_module.html">Click here</a> to learn more
about the <strong>service</strong> module.</p>
</li>
</ul>
</div>
<hr>
<div class="paragraph lead">
<p>Section 4: Saving your Playbook</p>
</div>
<div class="paragraph">
<p>Now that you&#8217;ve completed writing your playbook, it would be a shame not to keep it.</p>
</div>
<div class="paragraph">
<p>Use the <code><code>write/quit</code></code> method in <code><code>vi</code></code> or <code><code>vim</code></code> to save your playbook, i.e. <code><code>Esc :wq!</code></code></p>
</div>
<div class="paragraph">
<p>And that should do it.  You should now have a fully written playbook called <code><code>install_apache.yml</code></code>.
You are ready to automate!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Ansible (well, YAML really) can be a bit particular about formatting especially around indentation/spacing.  When you all get back to the office,
read up on this <a href="http://docs.ansible.com/ansible/YAMLSyntax.html">YAML Syntax</a> a bit more and it will save you some headaches later.  In the meantime, your completed playbook should look
like this.  Take note of the spacing and alignment.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">---
- hosts: web
  name: Install the apache web service
  become: yes

  tasks:
    - name: install apache
      yum:
        name: httpd
        state: present

    - name: start httpd
      service:
        name: httpd
        state: started</code></pre>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
    <footer class="footer-openshift">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-4 col-md-3 logo">
        <a href="https://www.redhat.com/"></a>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-6 text-center">
        <div class="row">
          <div class="col-xs-12 col-md-4">
            <a href="https://www.redhat.com/en/about/privacy-policy">
              Privacy Policy
            </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="https://www.redhat.com/en/about/terms-use">
            Terms and Conditions
          </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="https://www.redhat.com/en/technologies/industries/government">
            Public Sector
          </a>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-3 text-right">
        <a id="built_with_asciibinder" href="http://asciibinder.org/">
          <img src="../../latest/_images/asciibinder_web_logo.svg" alt="AsciiBinder" />
        </a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>